<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>Delta Optics | Ø§Ù„Ù…Ø¹Ø±Ø¶ ÙˆØ§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root { --primary: #00796B; --gold: #D4AF37; --bg: #FAFAFA; --text: #37474F; }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Tajawal', sans-serif; }
        body { background: var(--bg); color: var(--text); padding-bottom: 60px; }
        
        header { background: #fff; box-shadow: 0 2px 10px rgba(0,0,0,0.05); position: fixed; width: 100%; top: 0; z-index: 1000; height: 60px; display: flex; align-items: center; justify-content: space-between; padding: 0 15px; }
        .back-btn { font-size: 1.2rem; color: var(--primary); }

        /* AI Analysis Section */
        .ai-section { 
            margin: 80px 15px 20px; padding: 20px; background: white; border-radius: 15px; 
            border: 2px dashed var(--primary); text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }
        .ai-btn { background: var(--primary); color: white; border: none; padding: 12px 25px; border-radius: 50px; font-weight: 800; cursor: pointer; margin-top: 10px; }
        #analysis-result { margin-top: 15px; font-size: 0.95rem; line-height: 1.6; color: #444; display: none; background: #f0f7f6; padding: 15px; border-radius: 10px; }

        .gallery-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 15px; max-width: 1200px; margin: 0 auto; }
        .product-card { background: #fff; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.04); border: 1px solid #f0f0f0; }
        .img-box { height: 160px; background: #f4f4f4; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        .img-box img { width: 100%; height: 100%; object-fit: cover; opacity: 0; transition: 0.5s; }
        .img-box img.loaded { opacity: 1; }
        .info { padding: 10px; text-align: center; }
        .wa-btn { display: block; background: #25D366; color: white; padding: 8px; border-radius: 6px; font-weight: bold; margin-top: 5px; text-decoration: none; font-size: 0.8rem; }
    </style>
</head>
<body>

    <header>
        <a href="index.html" class="back-btn"><i class="fas fa-arrow-right"></i></a>
        <span style="font-weight: 800; color: var(--primary);">Ø§Ù„Ù…Ø¹Ø±Ø¶ Ø§Ù„Ø°ÙƒÙŠ</span>
        <div style="width:20px;"></div>
    </header>

    <div class="ai-section">
        <i class="fas fa-magic" style="font-size: 2rem; color: var(--gold); margin-bottom: 10px;"></i>
        <h3>Ù…Ø­Ù„Ù„ Ø§Ù„ÙˆØ¬Ù‡ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</h3>
        <p style="font-size: 0.85rem; color: #666;">Ø§Ø±ÙØ¹ ØµÙˆØ±ØªÙƒ Ù„Ù†Ø®Ø¨Ø±Ùƒ Ø¨Ø£ÙØ¶Ù„ Ø´ÙƒÙ„ Ù†Ø¸Ø§Ø±Ø© ÙŠÙ†Ø§Ø³Ø¨Ùƒ</p>
        
        <input type="file" id="face-input" accept="image/*" style="display: none;" onchange="startAnalysis(event)">
        <button class="ai-btn" onclick="document.getElementById('face-input').click()">Ø¥Ø¶Ø§ÙØ© ØµÙˆØ±Ø© Ù„Ù„ØªØ­Ù„ÙŠÙ„</button>
        
        <div id="analysis-result">
            <strong id="status-text">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„...</strong>
            <p id="ai-advice"></p>
        </div>
    </div>

    <div class="gallery-grid" id="container"></div>

    <script>
        const API_KEY = "AIzaSyAC2HSVhR1DIt4Ry5OZQFge-rZr04FvfUQ"; // Ù…ÙØªØ§Ø­Ùƒ Ø§Ù„ÙØ¹Ø§Ù„
        const CHECK_LIMIT = 10;

        // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØµÙˆØ±
        document.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('container');
            let html = '';
            for (let i = 1; i <= CHECK_LIMIT; i++) { html += createCard('medical', i, `m${i}.jpg.jpg`); }
            for (let i = 1; i <= CHECK_LIMIT; i++) { html += createCard('sun', i, `s${i}.jpg.jpg`); }
            container.innerHTML = html;
        });

        function createCard(type, index, fileName) {
            return `
            <div class="product-card">
                <div class="img-box">
                    <img src="${fileName}" loading="lazy" onload="this.classList.add('loaded')" onerror="this.closest('.product-card').remove()">
                </div>
                <div class="info">
                    <h4 style="font-size:0.8rem;">${type==='medical'?'Ø·Ø¨ÙŠ':'Ø´Ù…Ø³ÙŠ'} #${index}</h4>
                    <a href="https://wa.me/962775549700?text=Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ù† ${fileName}" class="wa-btn">Ø·Ù„Ø¨ ÙˆØ§ØªØ³Ø§Ø¨</a>
                </div>
            </div>`;
        }

        // Ù…Ù†Ø·Ù‚ ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙˆØ¬Ù‡ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Gemini Vision
        async function startAnalysis(event) {
            const file = event.target.files[0];
            if (!file) return;

            const resultBox = document.getElementById('analysis-result');
            const statusText = document.getElementById('status-text');
            const adviceText = document.getElementById('ai-advice');

            resultBox.style.display = 'block';
            statusText.innerText = "Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙˆØ±Ø© Ø¹Ø¨Ø± Ø§Ù„Ù€ AI...";
            adviceText.innerText = "";

            const reader = new FileReader();
            reader.onload = async () => {
                const base64Data = reader.result.split(',')[1];
                
                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({
                            contents: [{
                                parts: [
                                    { text: "Ø­Ù„Ù„ Ø´ÙƒÙ„ Ø§Ù„ÙˆØ¬Ù‡ ÙÙŠ Ø§Ù„ØµÙˆØ±Ø© (Ø¯Ø§Ø¦Ø±ÙŠØŒ Ø¨ÙŠØ¶Ø§ÙˆÙŠØŒ Ù…Ø±Ø¨Ø¹ØŒ Ø£Ùˆ Ù‚Ù„Ø¨) ÙˆØ§Ù†ØµØ­ Ø¨Ù†ÙˆØ¹ Ø¥Ø·Ø§Ø±Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ø±Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù„Ù‡ Ø¨Ø§Ø®ØªØµØ§Ø± ÙˆØ¨Ø§Ù„Ø¹Ø§Ù…ÙŠØ© Ø§Ù„Ø£Ø±Ø¯Ù†ÙŠØ©." },
                                    { inline_data: { mime_type: "image/jpeg", data: base64Data } }
                                ]
                            }]
                        })
                    });
                    const data = await response.json();
                    statusText.innerText = "ØªÙ… Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰";
                    adviceText.innerText = data.candidates[0].content.parts[0].text;
                } catch (err) {
                    statusText.innerText = "Ø¹Ø°Ø±Ø§Ù‹ØŒ ÙØ´Ù„ Ø§Ù„ØªØ­Ù„ÙŠÙ„.";
                    adviceText.innerText = "ØªØ£ÙƒØ¯ Ù…Ù† Ø¬ÙˆØ¯Ø© Ø§Ù„ØµÙˆØ±Ø© ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.";
                }
            };
            reader.readAsDataURL(file);
        }
    </script>
</body>
</html>
